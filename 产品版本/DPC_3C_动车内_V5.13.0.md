3C Version Publish - V5.13.0动车对内数据终端
=================
  
版本修订
-----------------------------------

日期 | 作者 |  说明
-|-|-
2019/12/16| xuyong| add

目标
-----------------------------------

1. AI智能机（大数据组）不再更新oracle数据库，将这部分功能在3C终端实现：解析服务调整AI接口，AI智能机识别后输出新格式，3C AI 接口消费消息后更新数据库

风险
-----------------------------------

1. 原有AI智能机按自己处理能力获取待处理数据，目前版本所有报警消息都会推送给智能机，如果消息处理远低于数据中心处理能力，可能会积压；建议AI识别时增加一些策略。

开发计划
-----------------------------------

SPRINT1:2019/12/16-2019/12/27

版本服务/组件列表
-----------------------------------

服务/组件 | 版本号 | 版本日期 | 是否更新 |升级内容
-|-|-|-|-
 动车对内数据终端网站| DPC_3C_I_V5.13.0 |2019/12/24| 有 |AI API地址可配置，报警性能监控图表优化，增加服务状态日志页面。
 3C辅助工具| 3CUtil_V3.1 |2019/12/24| 有 |增加历史数据删除功能
 3C解析文件集中收集服务| FileCollector_V1.1 |2019/10/16| 无 |
 动车对内解析服务| 3CDataInterface_D_5.5.0 |2019/12/24| 有 |修改AI智能机接口，按照2.0规范接入；增加进程状态消息
 车次信息计算服务| traininfo_V1.0 |2019/10/16| 无 |
 车次信息现场接收服务| traininfo-receive_V1.0 |2019/10/16| 无 |
 SYN转发服务| C3SynAPI_V1.0 |2019/10/16| 无 |
 转发服务| 3CTransmit_5.8.1 |2019/10/16| 无  |
 主动检测时间计算服务|GpsTimeParser_V1.1.1 |2019/10/16| 无  |
 生成主动检测请求任务服务| RelayFileTask_V1.3|2019/10/16| 无 |
 请求车载主动检测数据服务| CreateFileTask_V1.3 |2019/10/16| 无 |
 3C主动检测数据解析、转发服务| 3COriDataProc_V1.0.4_SP1 |2019/10/16| 无 |
 3C缺陷报告生成服务| CreateDoc_V2.2 |2019/12/24| 有 |支持删除fastdfs文件
 3C数据解析WebAPI接口| DPC_3C_Parser_WebAPI_V3.2.0 |2019/12/13| 有 |增加3C服务状态监控；修改查询时间为Raisetime;
 AI消息消费服务|AI_MQConsumerService_V2.0|2019/12/24| 有 | 添加消息中间处理逻辑
 AI智能机WebAPI| AiWebAPI_V2.0 |2019/12/24| 有 | 添加alarm数据更新及记录历史数据
 3C解析监控服务| 3CMonoitor_3.2.0|2019/12/24| 有 |增加raisetime报警文件时间
 云转发服务| 3CDataTransmitterBroker_V1.5.0 |2019/12/13| 无 |

动车对内数据终端网站 - DPC_3C_I_V5.13.0
-----------------------------------

1. 版本号
DPC_3C_I_V5.13.0
2. 更新内容
    1. AI API地址可配置
    2. 报警性能监控图表优化
    3. 增加3C服务监控页面
    4. 修复报警ID为空值全表查询数据库
    5. 删除查询alarm时的动态sql条件： SEVERITY IN (SELECT DIC_CODE FROM SYS_DIC WHERE P_CODE = 'SEVERITY')

3. 配置变更

动车对内解析服务 - 3CDataInterface_D_5.5.0
-----------------------------------

1. 版本号
3CDataInterface_D_5.5.0
2. 更新内容
    1. AI智能机接口2.0规范
    2. 增加重要消息接口
3. mis_parameter
    1. add ->	C3Parser.Public.011	ServiceStatus.API	http://192.168.1.250:9091	服务状态消息接口	C3Parser.Public

3C缺陷报告生成服务 - CreateDoc_V2.1
-----------------------------------

1. 版本号
CreateDoc_V2.1
2. 更新内容
    1. 支持fastdfs文件删除功能

3C数据解析WebAPI接口 - Parser_WebAPI_V3.2.0
-----------------------------------

1. 版本号 Parser_WebAPI_V3.2.0
2. 更新内容
    1. 服务状态监听接口
    2. 查询时间collecttime统一修改成raisetime,升级时需要初始化raisetime为collecttime
3. 数据库脚本
    1. 见后：https://gtjg/svn/DPC/doc/6.版本、配置管理/Oracle/数据库脚本/DB1.66.0_V5.13对内动车解析监控数据库脚本.sql

3C解析监控服务 - 3CMonitor_V3.2
-----------------------------------

1. 版本号 3CMonitor_V3.2
2. 更新内容
    1. 增加raisetime记录

AI消息消费服务 - AI_MQConsumerService_V2.0
-----------------------------------

1. 版本号
AI_MQConsumerService_V2.0
2. 更新内容
    1. 更新Kafka接入的消息格式
    2. 增加对消息的中间处理，使之兼容之前的数据格式

AI智能机WebAPI - AiWebAPI_V2.0
-----------------------------------

1. 版本号
AiWebAPI_V2.0
2. 更新内容
    1. 添加对alarm数据存入历史表逻辑，并更改alarm相关字段

升级脚本
-----------------------------------

1. https://gtjg/svn/DPC/doc/6.版本、配置管理/Oracle/数据库脚本/DB1.65_3C_AI接入.sql
2. https://gtjg/svn/DPC/doc/6.版本、配置管理/Oracle/数据库脚本/DB1.66.0_V5.13对内动车解析监控数据库脚本.sql

附件
-----------------------------------

[AI交互协议](../解析服务/02文档/AI交互协议 V1.2.0（地铁、3C数据中心）.doc)