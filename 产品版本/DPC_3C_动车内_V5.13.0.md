3C Version Publish - V5.13.0动车对内数据终端
=================
  
版本修订
-----------------------------------

日期 | 作者 |  说明
-|-|-
2019/12/16| xuyong| add

目标
-----------------------------------

1. AI智能机（大数据组）不再更新oracle数据库，将这部分功能在3C终端实现：解析服务调整AI接口，AI智能机识别后输出新格式，3C AI 接口消费消息后更新数据库
2. /

开发计划
-----------------------------------

SPRINT1:2019/12/16-2019/12/27

版本服务/组件列表
-----------------------------------

服务/组件 | 版本号 | 版本日期 | 是否更新 |升级内容
-|-|-|-|-
 动车对内数据终端网站| DPC_3C_I_V5.12.0 |2019/12/13| 有 |历史数据实时提图；主动检测接入WebAPI;报表地址下载问题；
 3C辅助工具| 3CUtil |2019/12/13| 有 |支持将已解析过或解析失败的报警消息重新写入AlarmReparsedTopic
 3C解析文件集中收集服务| FileCollector_V1.1 |2019/10/16| 无 |
 动车对内解析服务| 3CDataInterface_D_5.4.0 |2019/12/13| 有 |修复图片路径标识问题；支持处理OSS异常数据；支持解析指定的报警文件。
 车次信息计算服务| traininfo_V1.0 |2019/10/16| 无 |
 车次信息现场接收服务| traininfo-receive_V1.0 |2019/10/16| 无 |
 SYN转发服务| C3SynAPI_V1.0 |2019/10/16| 无 |
 转发服务| 3CTransmit_5.8.1 |2019/10/16| 有 |排查内存泄漏BUG;修复虚拟目录依赖问题
 主动检测时间计算服务|GpsTimeParser_V1.1.1 |2019/10/16| 有 | 修复虚拟目录依赖问题
 生成主动检测请求任务服务| RelayFileTask_V1.3|2019/10/16| 无 |
 请求车载主动检测数据服务| CreateFileTask_V1.3 |2019/10/16| 无 |
 3C主动检测数据解析、转发服务| 3COriDataProc_V1.0.4_SP1 |2019/10/16| 无 |
 3C图片提供服务| 3CDataProviderService_V5.0.8.1_SP1 |2019/10/16| 无 | 停用
 3C缺陷报告生成服务| CreateDoc_V2.1 |2019/12/13| 有 |生成报表上传至fastdfs更新aux路径
 3C数据解析WebAPI接口| DPC_3C_Parser_WebAPI_V3.1.0 |2019/12/13| 有 |基于3.0支持对内fastDFS数据存储模式
 AI消息消费服务|AI_MQConsumerService_V2.0|2019/12/13| 无 |
 AI智能机WebAPI| AiWebAPI_V2.0 |2019/12/13| 无 |
 3C解析监控服务| 3CMonoitor_3.1.0|2019/11/16| 无 |
 云转发服务| 3CDataTransmitterBroker_V1.5.0 |2019/12/13| 有 |优化云转发心跳功能，支持通过超时参数来设置超时状态，避免网络心跳频繁造成资源未释放

动车对内数据终端网站 - DPC_3C_I_V5.12.0
-----------------------------------

1. 版本号
DPC_3C_I_V5.12.0
2. 更新内容
    1. 历史数据实时提图
    2. 主动检测接入WebAPI
    3. 解析监控统计和查询
    4. 修复报警时禁止修改上报时间
    5. 所有报表导出和下载功能：报表服务生成报表上传fastdfs后，网站通过fastdfs地址下载
    6. 打开辅助，部分报警仍然无图像显示（图1）；关闭辅助后，部分报警详情页界面显示乱码情况（V5.11.1 ）
    7. 检测数据页面，“位置”列表还是采用之前的左对齐（V5.11.1 ）
    8. 在缺陷列表页选择供电段，仍然存在该路局车号情况

3. 配置变更
    1. 参考数据库表
    2. V5.11.1 -> AlarmAUXPIC_API:http://192.168.3.226:9100	3C辅助图像API接口
    3. V5.12.1 -> AlarmIRVPIC_API:http://192.168.3.226:9100	3C红外图像API接口
    4. V5.12.1 -> AlarmMV2PIC_API:http://192.168.3.226:9100	3C局部图像API接口
    5. V5.12.1 -> AlarmMV3PIC_API:http://192.168.3.226:9100	3C全景图像API接口
    6. V5.12.1 -> AlarmIRVTEMP_API:http://192.168.3.226:9100	3C红外温度API接口
    7. V5.12.1 -> AlarmParserMonitorLog_API:http://192.168.3.226:9100	3C解析服务性能日志统计

动车对内解析服务 - 3CDataInterface_D_5.4.0
-----------------------------------

1. 版本号
3CDataInterface_D_5.4.0
2. 更新内容
    1. 修复图片路径标识问题
    2. 修复报警未解析时写入OSS数据不完整
    3. 异常报警消息的解析支持：通过json消息写入kafka topic重新解析
    4. 服务启动检查同名的服务，如果有假死服务kill
3. App.config配置变更
    1. kafka.alarmReparsedTopic = "c3-d-alarmReparsed-dev" // 重新解析消息队列

3C辅助工具 - 3CUtils_V3.0.0
-----------------------------------

1. 版本号 3CUtils_V3.0.0
2. 更新内容
    1. 支持将已解析过或解析失败的报警消息重新写入AlarmReparsedTopic

3C缺陷报告生成服务 - CreateDoc_V2.0
-----------------------------------

1. 版本号
CreateDoc_V2.0
2. 更新内容
    1. 重构
    2. 支持报表文件输出到fastdfs
    3. 兼容实时提图V3.0

3C数据解析WebAPI接口 - Parser_WebAPI_V3.1.0
-----------------------------------

1. 版本号 Parser_WebAPI_V3.1.0
2. 更新内容
    1. 基于3.0支持对内fastDFS数据存储模式
    2. 提供解析日志统计接口

云转发服务 - 3CDataTransmitterBroker_V1.5.0
-----------------------------------

1. 版本号 3CDataTransmitterBroker_V1.5.0
2. 更新内容
    1. 优化云转发心跳功能，支持通过超时参数来设置超时状态，避免网络心跳频繁造成资源未释放
    2.  心跳探测模式，0：单独网络探测，1：数据发送状态探测
        add key="HeartBeat.mode" value="1"
        心跳总级数
        add key="HeartBeat.grade" value="3"
        心跳重置间隔初始时间
        add key="HeartBeat.span" value="1"
        心跳重置间隔时间倍数， 间隔时长为：grade*span*multiple
        add key="HeartBeat.multiple" value="2"

注意事项/升级建议
-----------------------------------

1. 更新一个时间段内的报警状态pic_file_location=2
2. 删除fastdfs服务器上对应时间的jpg，确保删除的报警pic_file_location=2，否则会出现报警图片异常
